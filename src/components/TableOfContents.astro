---

---

<button
  id="toggle"
  commandfor="tocpopover"
  command="toggle-popover"
  class="bg-secondary sticky top-4 rounded-xs p-1 md:hidden"
  >Table of Contents</button
>
<div
  popover
  id="tocpopover"
  class="bg-secondary backdrop:bg-secondary text-secondary-foreground h-2/3 w-2/3 p-4 pl-4 backdrop:opacity-50 md:sticky md:top-4 md:block md:h-full md:w-full md:overflow-visible md:bg-transparent"
>
  <button
    class="bg-accent absolute end-0 top-0 aspect-square w-6 rounded-xs p-1 md:hidden"
    commandfor="tocpopover"
    command="hide-popover"
    title="close">x</button
  >
  <div class="absolute md:left-[calc(100%+var(--spacing)*8)]">
    <span>Table of Contents</span>
    <aside>
      <nav>
        <ul id="table-of-contents" class="sticky top-0">
          <li class="ps-4">
            <a href="#">Start</a>
          </li>
        </ul>
      </nav>
    </aside>
  </div>
</div>

<script defer is:inline>
  window.addEventListener("DOMContentLoaded", () => {
    const toc = document.querySelector("#table-of-contents");
    const df = document.createDocumentFragment();
    document
      .querySelectorAll("h2,h3,h4,h5,h6")
      .values()
      .filter((el) => el.id)
      .forEach((el) => {
        const level = el.tagName.toLowerCase().replaceAll("h", "") ?? 6;
        const li = document.createElement("li");
        li.style.paddingInlineStart = `${level / 2}rem`;
        const a = document.createElement("a");
        a.textContent = el.textContent;
        a.href = `#${el.id}`;
        li.appendChild(a);
        df.appendChild(li);
      });
    toc.appendChild(df);
    toc.addEventListener("click", (el) => {
      console.log(el);
      if (el.target.tagName === "A") {
        document.querySelector("#tocpopover").hidePopover();
      }
    });
  });
</script>
